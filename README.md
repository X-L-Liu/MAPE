# MAPE: Defending Against Transferable Adversarial Attacks Using Multi-Source Adversarial Perturbations Elimination

[//]: # ([Paper]&#40;&#41; )

> **Abstract:** *Neural networks are vulnerable to meticulously crafted adversarial examples, leading to high-confidence
> misclassifications in image classification tasks. Due to their stealthiness and difficulty in detection, transferable 
> adversarial attacks have become a significant focus of defense. In this work, we propose a deep learning defense known 
> as multi-source adversarial perturbations elimination (MAPE) to counter diverse transferable attacks. MAPE 
> comprises the single-source adversarial perturbation elimination (SAPE) mechanism and the pre-trained 
> models probabilistic scheduling algorithm (PPSA). SAPE utilizes a thoughtfully designed channel-attention U-Net as 
> the defense model and employs adversarial examples generated by a pre-trained model (e.g., ResNet) for its training, 
> thereby enabling the elimination of known adversarial perturbations. PPSA introduces model difference quantification 
> and negative momentum to strategically schedule multiple pre-trained models, thereby maximizing the differences among 
> adversarial examples during the defense model's training and enhancing its robustness in eliminating unseen adversarial 
> perturbations. MAPE effectively eliminates adversarial perturbations in various adversarial examples, providing a 
> robust defense against unseen attacks from different substitute models. In a black-box attack scenario utilizing 
> ResNet-34 as the target model, our approach achieves average defense rates of over 95.1% on CIFAR-10 and over 71.5% 
> on Mini-ImageNet, demonstrating state-of-the-art performance.*
>

## Installation

```
conda create -n MAPE python=3.11.9
conda activate MAPE
conda install pytorch==2.2.2 torchvision==0.17.2 torchaudio==2.2.2 pytorch-cuda=12.1 -c pytorch -c nvidia
```
PyTorch is not version-sensitive. The project can typically run on other versions of PyTorch as well. 
Furthermore, allow the system to automatically select the version when installing any other missing libraries.

## Pre-Training Classifiers

You can train various classifiers with `train_classifier.py`.

* For ResNet34 on CIFAR-10
  `python train_classifier.py --classifier_name ResNet34 --dataset_name cifar10`
* For GoogLeNet on CIFAR-10
  `python train_classifier.py --classifier_name GoogLeNet --dataset_name cifar10`
* For VGG19 on CIFAR-10
  `python train_classifier.py --classifier_name VGG19 --dataset_name cifar10`
* For MobileNetV2 on CIFAR-10
  `python train_classifier.py --classifier_name MobileNetV2 --dataset_name cifar10`

## Training SAPE

* Assume the pre-trained model is ResNet34, for CAU-Net-5 on CIFAR-10, run the following command.
  `python train_sape.py --classifier_name ResNet34`


## Training MAPE

* Assume the pre-trained models are ResNet34, GoogLeNet, MobileNetV2, and VGG19, for CAU-Net-5 on CIFAR-10. After modifying utils/classifiers_path.py, run the following command.
  `python train_mape.py --classifier_name ResNet34,GoogLeNet,MobileNetV2,VGG19`


## Evaluation

* Defending FGSM and PGD-20 for ResNet34 with MAPE on CIFAR-10.
`python evaluate.py --attack_methods FGSM,PGD_20 --dataset_name cifar10 --classifier_name ResNet34 --net_load_path XXXXXX`
